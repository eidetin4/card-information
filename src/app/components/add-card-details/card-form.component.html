<div class="bg-white shadow-md rounded-lg p-6 border border-gray-200">
  <form [formGroup]="cardDetailsForm" (ngSubmit)="submitCard()" class="space-y-4">
    <!-- Card Number -->
    <div>
      <label for="cardDetails" class="block text-sm font-medium text-gray-700 mb-1">Kortnummer</label>
      <input
        type="text"
        id="cardDetails"
        formControlName="cardDetails"
        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
        placeholder="1234 5678 9012 3456"
      >
      @if (cardDetailsForm.get('cardDetails')?.invalid && cardDetailsForm.get('cardDetails')?.touched) {
        <p class="text-red-500 text-sm mt-1">
          {{ getCardNumberErrorMessage() }}
        </p>
      }
    </div>

    <!-- Expiry Date -->
    <div>
      <label for="expiryDate" class="block text-sm font-medium text-gray-700 mb-1">Utl√∏psdato</label>
      <input
        type="text"
        id="expiryDate"
        formControlName="expiryDate"
        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
        placeholder="MM/YY"
      >
      @if (cardDetailsForm.get('expiryDate')?.invalid && cardDetailsForm.get('expiryDate')?.touched) {
        <p class="text-red-500 text-sm mt-1">
          {{ getExpiryDateErrorMessage() }}
        </p>
      }
    </div>

    <!-- CVV -->
    <div>
      <label for="cvv" class="block text-sm font-medium text-gray-700 mb-1">CVV</label>
      <input
        type="text"
        id="cvv"
        formControlName="CVV"
        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
        placeholder="123"
      >
      @if (cardDetailsForm.get('CVV')?.invalid && cardDetailsForm.get('CVV')?.touched) {
        <p class="text-red-500 text-sm mt-1">
          {{ getCvvErrorMessage() }}
        </p>
      }
    </div>

    <!-- Issuer -->
    <div>
      <label for="issuer" class="block text-sm font-medium text-gray-700 mb-1">Korttype</label>
      <select
        id="issuer"
        formControlName="issuer"
        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
        <option value="">Velg korttype</option>
        <option value="VISA">VISA</option>
        <option value="MASTERCARD">Mastercard</option>
        <option value="AMEX">American Express</option>
      </select>
      @if (cardDetailsForm.get('issuer')?.invalid && cardDetailsForm.get('issuer')?.touched) {
        <p class="text-red-500 text-sm mt-1">Vennligst velg korttype</p>
      }
    </div>

    <!-- Currency (Hidden since it's defaulted to NOK) -->
    <input type="hidden" formControlName="currency">

    <!-- Submit Button -->
    <div>
      <button
        type="submit"
        [disabled]="cardDetailsForm.invalid || isSubmitting"
        class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-400"
      >
        @if (isSubmitting) {
          <span>Lagrer...</span>
        } @else {
          <span>Lagre kort</span>
        }
      </button>
    </div>

    <!-- Success Message -->
    @if (showSuccessMessage) {
      <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mt-4" role="alert">
        <span class="block sm:inline">Betalingskortet ble registrert!</span>
      </div>
    }

    <!-- Error Message -->
    @if (errorMessage) {
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mt-4" role="alert">
        <span class="block sm:inline">{{ errorMessage }}</span>
      </div>
    }
  </form>
</div>
